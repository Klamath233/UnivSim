<html>
<head>
    <title>CS174A, Fall 2014, Assignment 2, Xi Han</title>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/index.css">
  </head>

<body>
  <div class="wrapper">
    <h1 class="title">
      Physics Demo
    </h1>
    <div class="group">
      <div class="col canvas">
        <canvas id="main-canvas" width="512" height="512"></canvas>
      </div>
      <div class="col instruction">
        <h2 id="instruction-header"></h2>
        <ol>
        </ol>

       <!--  <div class="clickable" id="rp-button">Play!</div> -->
      </div>
    </div>
  </div>
</body>

<script type="x-shader/x-vertex" id="vertex-shader">
  precision mediump float;

  attribute vec4 vPosition;
  attribute vec4 vNormal;

  uniform vec4 lp;
  uniform float sn;
  uniform mat4 m;
  uniform mat4 v;
  uniform mat4 pj;

  varying vec3 N, L, E;

  void main() {

    vec3 pos = (v * m * vPosition).xyz;

    L = normalize((v * lp).xyz - pos);
    E = normalize(-pos);
    N = normalize(v * m * vNormal).xyz;

    gl_Position = pj * v * m * vPosition;

  }
</script>

<script type="x-shader/x-fragment" id="fragment-shader">
  precision mediump float;

  uniform vec4 ap;
  uniform vec4 dp;
  uniform vec4 sp;
  uniform float sn;

  varying vec3 N, L, E;

  void main() {

    vec3 H = normalize(L + E);

    vec4 ambient = ap;

    float kd = max(dot(L, normalize(N)), 0.0);
    vec4 diffuse = kd * dp;

    float ks = pow(max(dot(normalize(N), H), 0.0), sn);
    vec4 specular = ks * sp;

    if (dot(L, normalize(N)) < 0.0) {
      specular = vec4(0.0, 0.0, 0.0, 1.0);
    }

    vec4 fColor = vec4(0.0, 0.0, 0.0, 1.0);
    fColor = ambient + diffuse + specular;
    fColor.a = 1.0;

    gl_FragColor = fColor;

  }
</script>

<script type="text/javascript" src="js/lib/webgl-utils.js"></script>
<script type="text/javascript" src="js/lib/initShaders.js"></script>
<script type="text/javascript" src="js/lib/MV.js"></script>
<script type="text/javascript" src="js/test.js"></script>
</html>